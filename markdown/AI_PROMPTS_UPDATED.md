# AI服务商Prompts配置更新说明

## 更新说明 (2025-12-12)
基于 `../alpha-pilot-bot-okx/ai/ai.py` 的先进设计，全面优化了prompt结构，增加了：
- 价格位置分析
- 技术指标整合
- 提供商特定框架
- 市场情绪判断
- 风险控制提示

## 当前Prompt配置

### 1. 增强主交易Prompt (AIClient._build_trading_prompt)
位于: `alpha_trading_bot/ai/client.py` (第127-233行)

特点：
- 📊 **价格位置分析**: 计算相对当日价格区间的位置 (0-100%)
- 📈 **技术指标整合**: RSI、MACD、均线状态、ATR波动率
- 🎯 **市场情绪判断**: 基于RSI的超买超卖分析
- ⚠️ **动态风险控制**: 根据波动率调整止盈止损策略
- 💡 **智能决策框架**: 价格位置+技术指标的综合判断逻辑

### 2. 提供商特定增强Prompt (AIClient._build_enhanced_prompt)
位于: `alpha_trading_bot/ai/client.py` (第235-363行)

为Kimi和DeepSeek提供商定制的专业分析框架：

#### Kimi 框架特色：
- 📈 **15分钟周期专注**: 短线交易分析
- 🎯 **RSI指标重点**: 45.0 (正常区间判断)
- ⚡ **价格动能分析**: +2.50%变化率
- 📊 **支撑阻力判断**: 基于价格位置的动态支撑阻力
- 🚀 **交易风格**: 短线快进快出，严格止损

#### DeepSeek 框架特色：
- 🎯 **核心价格分析**: 当前价格位置深度解读
- 🔍 **技术形态识别**: 突破/反转信号捕捉
- 🎮 **博弈策略思维**: 考虑对手盘行为模式
- 📈 **趋势跟踪策略**: 在趋势中寻找最佳入场时机
- 💪 **交易风格**: 波段操作，精准入场

### 3. 基础Provider Prompt (BaseAIProvider.build_prompt)
位于: `alpha_trading_bot/ai/providers/base.py` (第31-77行)

增强版基础prompt，包含：
- 价格位置计算
- RSI技术指标
- ATR波动率显示
- 标准化JSON格式

## Prompt使用流程

1. **AIClient.generate_signal()** 根据提供商类型选择prompt策略：
   - Kimi/DeepSeek → 使用 `_build_enhanced_prompt()`
   - Qwen/OpenAI → 使用 `_build_trading_prompt()`

2. 构建包含以下要素的个性化prompt：
   - 📊 核心市场数据（价格、区间、位置、成交量、ATR）
   - 🔧 技术分析（RSI、MACD、均线、趋势、情绪）
   - 🎯 提供商特定分析框架
   - ⚡ 关键分析要求
   - ⚠️ 风险控制提示
   - 💡 决策要点总结

3. 每个提供商将增强后的prompt发送到各自的API

4. 响应解析现在支持更丰富的字段：
   ```json
   {
       "signal": "BUY/SELL/HOLD",
       "confidence": 0.8,
       "reason": "详细分析理由（不少于50字）",
       "holding_time": "建议持仓时间",
       "risk": "风险提示和止损建议"
   }
   ```

## 增强功能特点

### 🎯 价格位置分析
- 计算当前价格在当日区间内的相对位置 (0-100%)
- 提供价格位置的交易策略指导

### 📊 技术指标整合
- RSI指标状态判断（超买/超卖/正常）
- MACD信号识别
- 均线排列状态
- ATR波动率分析

### 🧠 市场情绪判断
- 基于RSI的市场情绪识别
- 波动率状态分类（震荡/高波动/正常）

### ⚠️ 动态风险控制
- 震荡市：缩小止盈止损，降低仓位
- 高波动：扩大止损，谨慎操作
- 正常波动：标准设置

### 🎮 提供商差异化
- **Kimi**: 专注15分钟短线，快进快出
- **DeepSeek**: 波段操作，精准入场
- **Qwen/OpenAI**: 综合技术分析

## 测试验证

更新后的prompts在实际测试中表现：
- ✅ 信号质量显著提升
- ✅ 分析理由更加详细专业
- ✅ 风险控制建议具体明确
- ✅ 提供商差异化明显

## 后续优化方向

1. **更多技术指标**: 可加入布林带、KDJ、威廉指标等
2. **多时间框架**: 支持多周期分析
3. **基本面因素**: 整合新闻、事件驱动因素
4. **机器学习优化**: 基于历史表现优化prompt权重
5. **实时市场状态**: 动态调整分析重点

---

## 旧版配置（已更新）

详见 `AI_PROMPTS.md` 文件查看历史配置